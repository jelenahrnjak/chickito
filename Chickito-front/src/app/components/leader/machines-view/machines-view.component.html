<h1>Mašine
    <input   
    style="float: right; width: 20%;"
    type="text"
    [(ngModel)]="termMachine"
    class="form-control"
    placeholder="Pretražite mašine"
    />    </h1>
<hr>

<div class="row"> 
    <div class="card"  *ngFor="let c of allMachines | filter: termMachine">
        
        <ul class="list-group list-group-flush" >
            <li class = "list-group-item"  style="cursor: pointer;" (click)="showWorkers(c)">
            <strong>{{c.name}}</strong> 
            </li>   
            <li style="height: 35px; text-align: center;" class="list-group-item"><strong>Model:</strong> {{c.model}}</li>    
            <li style="height: 35px;" class="list-group-item"><strong>Količina:</strong> {{c.quantity}}</li>    
            <li *ngIf="!c.documentation" style="height: 70px;" class="list-group-item">     
                <button class="btn-green btn" style=" margin-top: 3%; width: 100%;" (click)="displayEdit = 'block'; selectedMachine = c; resetNewDocumenation()">Dodaj dokumentaciju</button>  
            </li>       
            <li *ngIf="c.documentation" style="height: 70px;" class="list-group-item">     
                <button class="btn-green btn" style=" margin-top: 3%; width: 100%; " (click)="displayDescription = 'block'; selectedMachine = c; selectedDocumentation = c.documentation">Prikaži dokumentaciju</button>  
            </li>          
            <li style="height: 70px;" class="list-group-item">
                <button class="btn-green btn" style=" margin-top: 3%; width: 100%;" (click)="showWorkers(c)">Prikaži radnike</button>  
            </li> 
            <li style="height: 70px;" class="list-group-item">
                <button class="btn-green btn" style=" margin-top: 3%; width: 100%;" (click)="showEditMachine(c)">Izmeni</button>  
            </li> 
        </ul> 
    </div>

</div>


<div class="card-body" *ngIf="showWorkersForMachine">
    

    <h1>Radnici na mašini {{selectedMachine.name}} {{selectedMachine.model}}        
        <button class="btn-green btn" style="float: right; width: 15%;" (click)="getWorkersAvailableForMachine()">Dodaj radnika <li class="fa fa-plus"></li></button> 
    </h1>
    <hr>


    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr> 
                    <th>Ime i prezime</th>
                    <th>Email</th>
                    <th>Broj telefona</th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of allWorkers">  
                    <td>{{item.fullName}}</td>             
                    <td>{{item.email}}</td>           
                    <td>{{item.phoneNumber}}</td>                  
                    <td><span *ngIf="item.mainWorker" class="badge" style="color: #04664c;" style="cursor: pointer;">Poslovođa</span></td>
                    <td *ngIf="item.mainWorker"><span class="badge btn-red" (click)="changeMainWorker(item)" style="float:right; cursor: pointer;">Ukloni sa mesta poslovođe</span></td>
                    <td *ngIf="!item.mainWorker"><span class="badge btn-green" (click)="changeMainWorker(item)" style="float:right; cursor: pointer;">Postavi za poslovođu</span></td>
                    <td><span class="badge btn-red" (click)="deleteWorkerFromMachine(item)" style="cursor: pointer;">Ukloni</span></td>

                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Modal for documentation view -->
<div class="modal" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayDescription}" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Dokumentacija za mašinu {{selectedMachine.name}} {{selectedMachine.model}}</h5>
        </div> 

        <div  class="container" style="margin-top: 3%;"> 
            <div class="input-group mb-3"  *ngIf="selectedDocumentation.workInstructions">
                <strong>Uputstvo za rad:</strong>&nbsp;&nbsp;&nbsp;
                <label *ngIf="selectedDocumentation.workInstructions">{{selectedDocumentation.workInstructions}}</label><br> 
            </div>
            <div class="input-group mb-3"  *ngIf="selectedDocumentation.washingInstructions">
                <strong>Uputstvo za pranje:</strong>&nbsp;&nbsp;&nbsp;
                <label>{{selectedDocumentation.washingInstructions}}</label><br> 
            </div>
            <div class="input-group mb-3"  *ngIf="selectedDocumentation.maintenanceInstructions">
                <strong>Uputstvo za održavanje:</strong>&nbsp;&nbsp;&nbsp;
                <label>{{selectedDocumentation.maintenanceInstructions}}</label><br>
            </div>   
            <div *ngIf="selectedDocumentation.spareParts">
            <h4><strong>Rezervni delovi</strong></h4>
            <hr>
            <table class="table">
                <thead>
                    <tr> 
                        <th>Kataloški broj</th>
                        <th>Naziv</th> 
                        <th>Količina</th> 
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of selectedDocumentation.spareParts"> 
                        <td class="color-primary">{{item.stockNumber}}</td>
                        <td class="color-primary">{{item.name}}</td>
                        <td class="color-primary">{{item.quantity}}</td>
                    </tr>
                </tbody>
            </table>
            </div>
            <br> 
        </div>



        <br> 
          
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" style="background-color: #676564; border: #676564; width: 35%;" (click)="displayDescription = 'none'">Zatvori</button>
            <button type="button" class="btn btn-green" style="width: 35%;" (click)="displayDescription = 'none'; displayEdit = 'block'; newDocumentation = selectedDocumentation">Izmeni</button>

        </div>
    </div>
    </div>
</div>

<!-- Modal for adding user --> 
<div class="modal" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayAddingWorker}" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Dodavanje radnika na mašinu {{selectedMachine.name}} {{selectedMachine.model}}</h5>
        </div> 

        <div  class="container">  
            <br>
            <div class="input-group mb-4">
                <select class="form-control"  [(ngModel)]="selectedNewWorker" required>
                    <option style="color:gray" value="0" disabled selected>Radnik</option>
                    <option *ngFor="let item of workersForAdding" value="{{item.id}}">{{item.firstName}} {{item.lastName}}</option> 
                </select> 
            </div> 
            <div class="input-group mb-4" style="margin-left: 1%; ">
                <label for="roleCheck">Da li je poslovođa?</label>
                <input id="roleCheck" type="checkbox" style="margin-left: 10px; accent-color: #00553e" [(ngModel)]="isNewWorkerMain">
            </div> 
            <br> 
        </div>
 
          
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" style="background-color: #676564; border: #676564; width: 35%;" (click)="displayAddingWorker = 'none'">Odustani</button>
            <button type="button" class="btn btn-green" style="width: 35%;" (click)="displayAddingWorker = 'none'; addNewUser()" [disabled]="selectedNewWorker == 0">Potvrdi</button>
        </div>
    </div>
    </div>
</div>

<!-- Modal for editing documentation view -->
<div class="modal" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayEdit}" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Dokumentacijaa za mašinu {{selectedMachine.name}} {{selectedMachine.model}}</h5>
        </div> 

        <div  class="container" style="margin-top: 3%;"> 
            <strong>Uputstvo za rad:</strong><br>
            <div class="input-group mb-3" style="margin-top: 10px;"> 
                <textarea class="form-control" style="height: 10ch;" type="text" [(ngModel)]="newDocumentation.workInstructions"></textarea>
            </div>
            <strong>Uputstvo za pranje:</strong><br>
            <div class="input-group mb-3" style="margin-top: 10px;"> 
                <textarea class="form-control" style="height: 10ch;" type="text" [(ngModel)]="newDocumentation.washingInstructions"></textarea>
            </div>
            <strong>Uputstvo za održavanje:</strong><br>
            <div class="input-group mb-3" style="margin-top: 10px;"> 
                <textarea class="form-control" style="height: 10ch;" type="text" [(ngModel)]="newDocumentation.maintenanceInstructions"></textarea>
            </div> 
            <br><br>
            <div>
            <h4  ><strong>Rezervni delovi</strong>
            <button class="btn btn-green" style="float: right;" (click)="displayNewPart = 'block'">Dodaj <i class="fa fa-plus"></i></button></h4>
            <hr  style="margin-top: 30px;"> 
            <table class="table">
                <thead>
                    <tr> 
                        <th>Kataloški broj</th>
                        <th>Naziv</th> 
                        <th>Količina</th>
                        <th></th> 
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of newDocumentation.spareParts"> 
                        <td class="color-primary">{{item.stockNumber}}</td>
                        <td class="color-primary">{{item.name}}</td>
                        <td class="color-primary">{{item.quantity}}</td>
                        <td><span class="badge btn-red" (click)="deleteSpare(item)" style="cursor: pointer;">Ukloni</span></td>
    
                    </tr>
                </tbody>
            </table>
            </div>
            <br> 
        </div>



        <br> 
          
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" style="background-color: #676564; border: #676564; width: 35%;" (click)="displayEdit = 'none'">Zatvori</button>
            <button type="button" class="btn btn-green" style="width: 35%;" (click)="displayEdit = 'none'; addDocumentation()">Izmeni</button>

        </div>
    </div>
    </div>
</div>


<!-- Modal for adding sparePart -->
<div class="modal" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayNewPart}" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Dodavanje rezervnog dela</h5>
        </div> 

        <div  class="container" style="margin-top: 3%;"> 
            <div class="input-group mb-3">
                <strong>Naziv:</strong>&nbsp;&nbsp;&nbsp; 
                <input class="form-control" [(ngModel)]="newSparePart.name">
            </div>
            <div class="input-group mb-3">
                <strong>Kataloški broj:</strong>&nbsp;&nbsp;&nbsp;
                <input class="form-control" [(ngModel)]="newSparePart.stockNumber">
            </div>
            <div class="input-group mb-3">
                <strong>Količina:</strong>&nbsp;&nbsp;&nbsp; 
                <input class="form-control" type="number" [(ngModel)]="newSparePart.quantity">
            </div> 
            <br>
            <br> 
        </div>



        <br> 
          
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" style="background-color: #676564; border: #676564; width: 35%;" (click)="displayNewPart = 'none'; resetSparePart()">Zatvori</button>
            <button type="button" class="btn btn-green" style="width: 35%;" (click)="displayNewPart = 'none'; addSparePart()" [disabled]="newSparePart.name == '' || newSparePart.quantity == 0 || newSparePart.stockNumber == ''">Dodaj</button>

        </div>
    </div>
    </div>
</div>


<!-- Modal for editing machine -->
<div class="modal" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayEditMachine}" style="background-color: rgba(0, 0, 0, 0.5);">
    <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Izmena podataka o mašini</h5>
        </div> 

        <div  class="container" style="margin-top: 3%;"> 
            <div class="input-group mb-3">
                <strong>Naziv:</strong>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;
                <input class="form-control" [(ngModel)]="selectedMachine.name" disabled>
            </div>
            <div class="input-group mb-3" >
                <strong>Model:</strong>&nbsp;&nbsp;&nbsp;&nbsp;
                <input class="form-control" [(ngModel)]="newModel">
            </div>
            <div class="input-group mb-3">
                <strong>Količina:</strong>&nbsp;&nbsp;&nbsp; 
                <input class="form-control" type="number" [(ngModel)]="newQuantity">
            </div> 
            <br>
            <br> 
        </div>



        <br> 
          
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" style="background-color: #676564; border: #676564; width: 35%;" (click)="displayEditMachine = 'none';">Zatvori</button>
            <button type="button" class="btn btn-green" style="width: 35%;" (click)="displayEditMachine = 'none'; editMachine()" [disabled]="newQuantity == 0 || newModel == '' ">Izmeni</button>

        </div>
    </div>
    </div>
</div>